{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}}], "description": "RedEnvelop._send(address,address,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#140-149) sends eth to arbitrary user\n\tDangerous calls:\n\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n", "markdown": "[RedEnvelop._send(address,address,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L140-L149) sends eth to arbitrary user\n\tDangerous calls:\n\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L140-L149", "id": "9368a2bdf20b8807203a841dc838616a0179473a63153aae8dc76a6774e4521c", "check": "arbitrary-send-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "_random", "source_mapping": {"start": 4073, "length": 229, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [120, 121, 122], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_random(uint256,uint256)"}}, {"type": "node", "name": "uint256(keccak256(bytes)(abi.encode(block.timestamp + block.difficulty + block.number))) % (remainMoney / remainCount * 2) + 1", "source_mapping": {"start": 4169, "length": 126, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [121], "starting_column": 8, "ending_column": 134}, "type_specific_fields": {"parent": {"type": "function", "name": "_random", "source_mapping": {"start": 4073, "length": 229, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [120, 121, 122], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_random(uint256,uint256)"}}}}], "description": "RedEnvelop._random(uint256,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#120-122) uses a weak PRNG: \"uint256(keccak256(bytes)(abi.encode(block.timestamp + block.difficulty + block.number))) % (remainMoney / remainCount * 2) + 1 (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#121)\" \n", "markdown": "[RedEnvelop._random(uint256,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L120-L122) uses a weak PRNG: \"[uint256(keccak256(bytes)(abi.encode(block.timestamp + block.difficulty + block.number))) % (remainMoney / remainCount * 2) + 1](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L121)\" \n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L120-L122", "id": "73d6b1f2375cec486b5a5fa3dc4f897d690b26796f98801aa790c596cd4afe02", "check": "weak-prng", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "_random", "source_mapping": {"start": 4073, "length": 229, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [120, 121, 122], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_random(uint256,uint256)"}}, {"type": "node", "name": "uint256(keccak256(bytes)(abi.encode(block.timestamp + block.difficulty + block.number))) % (remainMoney / remainCount * 2) + 1", "source_mapping": {"start": 4169, "length": 126, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [121], "starting_column": 8, "ending_column": 134}, "type_specific_fields": {"parent": {"type": "function", "name": "_random", "source_mapping": {"start": 4073, "length": 229, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [120, 121, 122], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_random(uint256,uint256)"}}}}], "description": "RedEnvelop._random(uint256,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#120-122) performs a multiplication on the result of a division:\n\t- uint256(keccak256(bytes)(abi.encode(block.timestamp + block.difficulty + block.number))) % (remainMoney / remainCount * 2) + 1 (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#121)\n", "markdown": "[RedEnvelop._random(uint256,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L120-L122) performs a multiplication on the result of a division:\n\t- [uint256(keccak256(bytes)(abi.encode(block.timestamp + block.difficulty + block.number))) % (remainMoney / remainCount * 2) + 1](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L121)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L120-L122", "id": "bd5abf061b65d6a04b974d1102b266d6b1a0e38b0b81d11fbf3d4449e8820cde", "check": "divide-before-multiply", "impact": "Medium", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}, {"type": "node", "name": "tokenAddr == address(0)", "source_mapping": {"start": 5091, "length": 23, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [142], "starting_column": 13, "ending_column": 36}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}}], "description": "RedEnvelop._send(address,address,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#140-149) uses a dangerous strict equality:\n\t- tokenAddr == address(0) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#142)\n", "markdown": "[RedEnvelop._send(address,address,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L140-L149) uses a dangerous strict equality:\n\t- [tokenAddr == address(0)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L142)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L140-L149", "id": "1a6e53ecb04f50663c786a71a95800a9081678454f2ccec3085737bbbf94fe31", "check": "incorrect-equality", "impact": "Medium", "confidence": "High"}, {"elements": [{"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}, {"type": "node", "name": "remainCount == remainMoney", "source_mapping": {"start": 4621, "length": 26, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [130], "starting_column": 20, "ending_column": 46}, "type_specific_fields": {"parent": {"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}}}], "description": "RedEnvelop._cal_random_amount(uint256,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#124-138) uses a dangerous strict equality:\n\t- remainCount == remainMoney (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#130)\n", "markdown": "[RedEnvelop._cal_random_amount(uint256,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138) uses a dangerous strict equality:\n\t- [remainCount == remainMoney](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L130)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138", "id": "1c039ae62aca7178d777964b611dc8ccee386f16ab7b07f46c6c973d40a2398f", "check": "incorrect-equality", "impact": "Medium", "confidence": "High"}, {"elements": [{"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}, {"type": "node", "name": "require(bool,string)(msg.sender == redEnvelopInfos[redEnvelopId].creator,Not creator)", "source_mapping": {"start": 9133, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [216], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}}], "description": "RedEnvelop.drawback(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#213-229) uses a dangerous strict equality:\n\t- require(bool,string)(msg.sender == redEnvelopInfos[redEnvelopId].creator,Not creator) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#216)\n", "markdown": "[RedEnvelop.drawback(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229) uses a dangerous strict equality:\n\t- [require(bool,string)(msg.sender == redEnvelopInfos[redEnvelopId].creator,Not creator)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L216)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229", "id": "53fa2e78eed3607e8911a6b268108999935347006865c509f9cf5d1c134aacce", "check": "incorrect-equality", "impact": "Medium", "confidence": "High"}, {"elements": [{"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}, {"type": "node", "name": "remainCount == 1", "source_mapping": {"start": 4490, "length": 16, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [127], "starting_column": 13, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}}}], "description": "RedEnvelop._cal_random_amount(uint256,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#124-138) uses a dangerous strict equality:\n\t- remainCount == 1 (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#127)\n", "markdown": "[RedEnvelop._cal_random_amount(uint256,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138) uses a dangerous strict equality:\n\t- [remainCount == 1](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L127)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138", "id": "a73c43137d307f380a79acca2825e25d16a9d2103fb2dc5dfa782b1abe644e0e", "check": "incorrect-equality", "impact": "Medium", "confidence": "High"}, {"elements": [{"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].luckydrawInfos[msg.sender] == 0,Already luckydrew)", "source_mapping": {"start": 7452, "length": 91, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [186], "starting_column": 9, "ending_column": 100}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}}], "description": "RedEnvelop.luckydraw(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#182-211) uses a dangerous strict equality:\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].luckydrawInfos[msg.sender] == 0,Already luckydrew) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#186)\n", "markdown": "[RedEnvelop.luckydraw(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211) uses a dangerous strict equality:\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].luckydrawInfos[msg.sender] == 0,Already luckydrew)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L186)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211", "id": "e235b058fb68f7f9da77f73f6c4590cdc937ff480a6e5fc0c5651a325443abe5", "check": "incorrect-equality", "impact": "Medium", "confidence": "High"}, {"elements": [{"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].recipientInfos[msg.sender] == 0,Already opened)", "source_mapping": {"start": 5707, "length": 88, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [155], "starting_column": 9, "ending_column": 97}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}}], "description": "RedEnvelop.open(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#151-180) uses a dangerous strict equality:\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].recipientInfos[msg.sender] == 0,Already opened) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#155)\n", "markdown": "[RedEnvelop.open(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180) uses a dangerous strict equality:\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].recipientInfos[msg.sender] == 0,Already opened)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L155)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180", "id": "ebb11f29de18800de02ac077afad64bac8586a318a3c73b0223527f9b24d4cdb", "check": "incorrect-equality", "impact": "Medium", "confidence": "High"}, {"elements": [{"type": "variable", "name": "initTokenAddr", "source_mapping": {"start": 1929, "length": 21, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [64], "starting_column": 30, "ending_column": 51}, "type_specific_fields": {"parent": {"type": "function", "name": "initShareholder", "source_mapping": {"start": 1904, "length": 172, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [64, 65, 66, 67], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "initShareholder(address)"}}}}, {"type": "node", "name": "mambaCoinAddr = initTokenAddr", "source_mapping": {"start": 2040, "length": 29, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [66], "starting_column": 9, "ending_column": 38}, "type_specific_fields": {"parent": {"type": "function", "name": "initShareholder", "source_mapping": {"start": 1904, "length": 172, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [64, 65, 66, 67], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "initShareholder(address)"}}}}], "description": "RedEnvelop.initShareholder(address).initTokenAddr (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#64) lacks a zero-check on :\n\t\t- mambaCoinAddr = initTokenAddr (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#66)\n", "markdown": "[RedEnvelop.initShareholder(address).initTokenAddr](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L64) lacks a zero-check on :\n\t\t- [mambaCoinAddr = initTokenAddr](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L66)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L64", "id": "d445997a1ddd42e1996744e300c90194443291b942c80c9d61a0ac6847ba481c", "check": "missing-zero-check", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 8218, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [200], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)", "source_mapping": {"start": 5274, "length": 72, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [147], "starting_column": 13, "ending_column": 85}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "require(bool,string)(IERC20(mambaCoinAddr).transferFrom(msg.sender,address(this),LuckyDrawMamb),Insufficient MAMB)", "source_mapping": {"start": 8336, "length": 106, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [203], "starting_column": 9, "ending_column": 115}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 8218, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [200], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "LuckyDraw(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)", "source_mapping": {"start": 8709, "length": 122, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [208], "starting_column": 9, "ending_column": 131}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.luckydraw(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#182-211):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#200)\n\t\t- require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#147)\n\t- require(bool,string)(IERC20(mambaCoinAddr).transferFrom(msg.sender,address(this),LuckyDrawMamb),Insufficient MAMB) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#203)\n\tExternal calls sending eth:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#200)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- LuckyDraw(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#208)\n", "markdown": "Reentrancy in [RedEnvelop.luckydraw(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L200)\n\t\t- [require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L147)\n\t- [require(bool,string)(IERC20(mambaCoinAddr).transferFrom(msg.sender,address(this),LuckyDrawMamb),Insufficient MAMB)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L203)\n\tExternal calls sending eth:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L200)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [LuckyDraw(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L208)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211", "id": "19fb981f562163302a06c5bca032cefddbf04711a824869a5887f83976aaba52", "check": "reentrancy-events", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 6491, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [170], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)", "source_mapping": {"start": 5274, "length": 72, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [147], "starting_column": 13, "ending_column": 85}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "require(bool,string)(IERC20(mambaCoinAddr).transfer(msg.sender,BonusMamb),Transfer MAMB failed)", "source_mapping": {"start": 6718, "length": 86, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [174], "starting_column": 13, "ending_column": 99}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(IERC20(mambaCoinAddr).transfer(redEnvelopInfos[redEnvelopId].creator,BonusMamb),Transfer MAMB failed)", "source_mapping": {"start": 6818, "length": 113, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [175], "starting_column": 13, "ending_column": 126}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 6491, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [170], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "Open(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)", "source_mapping": {"start": 6952, "length": 117, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [178], "starting_column": 9, "ending_column": 126}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.open(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#151-180):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#170)\n\t\t- require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#147)\n\t- require(bool,string)(IERC20(mambaCoinAddr).transfer(msg.sender,BonusMamb),Transfer MAMB failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#174)\n\t- require(bool,string)(IERC20(mambaCoinAddr).transfer(redEnvelopInfos[redEnvelopId].creator,BonusMamb),Transfer MAMB failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#175)\n\tExternal calls sending eth:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#170)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- Open(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#178)\n", "markdown": "Reentrancy in [RedEnvelop.open(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L170)\n\t\t- [require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L147)\n\t- [require(bool,string)(IERC20(mambaCoinAddr).transfer(msg.sender,BonusMamb),Transfer MAMB failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L174)\n\t- [require(bool,string)(IERC20(mambaCoinAddr).transfer(redEnvelopInfos[redEnvelopId].creator,BonusMamb),Transfer MAMB failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L175)\n\tExternal calls sending eth:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L170)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [Open(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L178)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180", "id": "6c8ac071ba7e6e1199e52c7b2f18beff1479f275e4b6b60c3e500bc8ced0cda5", "check": "reentrancy-events", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "create", "source_mapping": {"start": 2449, "length": 1618, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "create(address,uint256,uint16,address[])"}}, {"type": "node", "name": "require(bool,string)(token.transferFrom(msg.sender,address(this),money),Token transfer fail)", "source_mapping": {"start": 3716, "length": 84, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [110], "starting_column": 13, "ending_column": 97}, "type_specific_fields": {"parent": {"type": "function", "name": "create", "source_mapping": {"start": 2449, "length": 1618, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "create(address,uint256,uint16,address[])"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "Create(envelopId,p.createTime + ExpireDay,p.createTime + CloseoutDay)", "source_mapping": {"start": 3962, "length": 72, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [116], "starting_column": 9, "ending_column": 81}, "type_specific_fields": {"parent": {"type": "function", "name": "create", "source_mapping": {"start": 2449, "length": 1618, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "create(address,uint256,uint16,address[])"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.create(address,uint256,uint16,address[]) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#75-118):\n\tExternal calls:\n\t- require(bool,string)(token.transferFrom(msg.sender,address(this),money),Token transfer fail) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#110)\n\tEvent emitted after the call(s):\n\t- Create(envelopId,p.createTime + ExpireDay,p.createTime + CloseoutDay) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#116)\n", "markdown": "Reentrancy in [RedEnvelop.create(address,uint256,uint16,address[])](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L75-L118):\n\tExternal calls:\n\t- [require(bool,string)(token.transferFrom(msg.sender,address(this),money),Token transfer fail)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L110)\n\tEvent emitted after the call(s):\n\t- [Create(envelopId,p.createTime + ExpireDay,p.createTime + CloseoutDay)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L116)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L75-L118", "id": "99e922da4622c925b6ab1f47d78f97e201378abf82e41f040e2a07ebd35776a8", "check": "reentrancy-events", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount)", "source_mapping": {"start": 10356, "length": 61, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [243], "starting_column": 9, "ending_column": 70}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)", "source_mapping": {"start": 5274, "length": 72, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [147], "starting_column": 13, "ending_column": 85}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount)", "source_mapping": {"start": 10356, "length": 61, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [243], "starting_column": 9, "ending_column": 70}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "CloseOut(redEnvelopId,amount)", "source_mapping": {"start": 10428, "length": 35, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [245], "starting_column": 9, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.closeout(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#231-247):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#243)\n\t\t- require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#147)\n\tExternal calls sending eth:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#243)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- CloseOut(redEnvelopId,amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#245)\n", "markdown": "Reentrancy in [RedEnvelop.closeout(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L231-L247):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L243)\n\t\t- [require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L147)\n\tExternal calls sending eth:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L243)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [CloseOut(redEnvelopId,amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L245)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L231-L247", "id": "a35704c25fc95dac28765b018fe881f662d2046bda1971899800a8b7e5822b7c", "check": "reentrancy-events", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 9548, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [225], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)", "source_mapping": {"start": 5274, "length": 72, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [147], "starting_column": 13, "ending_column": 85}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 9548, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [225], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "DrawBack(redEnvelopId,amount)", "source_mapping": {"start": 9634, "length": 35, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [227], "starting_column": 9, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.drawback(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#213-229):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#225)\n\t\t- require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#147)\n\tExternal calls sending eth:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#225)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- DrawBack(redEnvelopId,amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#227)\n", "markdown": "Reentrancy in [RedEnvelop.drawback(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L225)\n\t\t- [require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L147)\n\tExternal calls sending eth:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L225)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [DrawBack(redEnvelopId,amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L227)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229", "id": "f449401ea7f6fc4904c12e2c4367317d198e93459a4f467b4de0441e02005d10", "check": "reentrancy-events", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)", "source_mapping": {"start": 5442, "length": 74, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [152], "starting_column": 9, "ending_column": 83}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(block.timestamp < redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Expired)", "source_mapping": {"start": 5526, "length": 90, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [153], "starting_column": 9, "ending_column": 99}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].remainCount > 0,No share left)", "source_mapping": {"start": 5626, "length": 71, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [154], "starting_column": 9, "ending_column": 80}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].recipientInfos[msg.sender] == 0,Already opened)", "source_mapping": {"start": 5707, "length": 88, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [155], "starting_column": 9, "ending_column": 97}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].candidates[msg.sender],Invalid candidate)", "source_mapping": {"start": 5865, "length": 82, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [158], "starting_column": 13, "ending_column": 95}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(IERC20(mambaCoinAddr).transfer(redEnvelopInfos[redEnvelopId].creator,BonusMamb),Transfer MAMB failed)", "source_mapping": {"start": 6818, "length": 113, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [175], "starting_column": 13, "ending_column": 126}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}}], "description": "RedEnvelop.open(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#151-180) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#152)\n\t- require(bool,string)(block.timestamp < redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Expired) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#153)\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].remainCount > 0,No share left) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#154)\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].recipientInfos[msg.sender] == 0,Already opened) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#155)\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].candidates[msg.sender],Invalid candidate) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#158)\n\t- require(bool,string)(IERC20(mambaCoinAddr).transfer(redEnvelopInfos[redEnvelopId].creator,BonusMamb),Transfer MAMB failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#175)\n", "markdown": "[RedEnvelop.open(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L152)\n\t- [require(bool,string)(block.timestamp < redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Expired)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L153)\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].remainCount > 0,No share left)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L154)\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].recipientInfos[msg.sender] == 0,Already opened)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L155)\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].candidates[msg.sender],Invalid candidate)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L158)\n\t- [require(bool,string)(IERC20(mambaCoinAddr).transfer(redEnvelopInfos[redEnvelopId].creator,BonusMamb),Transfer MAMB failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L175)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180", "id": "12f54bef46e3f25ae5f68dbf23b8f60945373b92c6966d14550ddb95108408f9", "check": "timestamp", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)", "source_mapping": {"start": 7183, "length": 74, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [183], "starting_column": 9, "ending_column": 83}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Not expired)", "source_mapping": {"start": 7267, "length": 94, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [184], "starting_column": 9, "ending_column": 103}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].remainCount > 0,No share left)", "source_mapping": {"start": 7371, "length": 71, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [185], "starting_column": 9, "ending_column": 80}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].luckydrawInfos[msg.sender] == 0,Already luckydrew)", "source_mapping": {"start": 7452, "length": 91, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [186], "starting_column": 9, "ending_column": 100}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}}], "description": "RedEnvelop.luckydraw(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#182-211) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#183)\n\t- require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Not expired) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#184)\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].remainCount > 0,No share left) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#185)\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].luckydrawInfos[msg.sender] == 0,Already luckydrew) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#186)\n", "markdown": "[RedEnvelop.luckydraw(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L183)\n\t- [require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Not expired)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L184)\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].remainCount > 0,No share left)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L185)\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].luckydrawInfos[msg.sender] == 0,Already luckydrew)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L186)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211", "id": "184d8e16c4b4228c4822a7beaeeefe781923b36e5e5900b2814a597928b901b0", "check": "timestamp", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}, {"type": "node", "name": "remainCount == 1", "source_mapping": {"start": 4490, "length": 16, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [127], "starting_column": 13, "ending_column": 29}, "type_specific_fields": {"parent": {"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}}}, {"type": "node", "name": "remainCount == remainMoney", "source_mapping": {"start": 4621, "length": 26, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [130], "starting_column": 20, "ending_column": 46}, "type_specific_fields": {"parent": {"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}}}, {"type": "node", "name": "remainCount < remainMoney", "source_mapping": {"start": 4783, "length": 25, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [133], "starting_column": 20, "ending_column": 45}, "type_specific_fields": {"parent": {"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}}}}], "description": "RedEnvelop._cal_random_amount(uint256,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#124-138) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- remainCount == 1 (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#127)\n\t- remainCount == remainMoney (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#130)\n\t- remainCount < remainMoney (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#133)\n", "markdown": "[RedEnvelop._cal_random_amount(uint256,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- [remainCount == 1](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L127)\n\t- [remainCount == remainMoney](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L130)\n\t- [remainCount < remainMoney](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L133)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138", "id": "4303b5905c7a0ef3af960bf748e172f6e7f99d3a1169f6fd15e0a189d72be370", "check": "timestamp", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)", "source_mapping": {"start": 8945, "length": 74, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [214], "starting_column": 9, "ending_column": 83}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Not expired)", "source_mapping": {"start": 9029, "length": 94, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [215], "starting_column": 9, "ending_column": 103}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(msg.sender == redEnvelopInfos[redEnvelopId].creator,Not creator)", "source_mapping": {"start": 9133, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [216], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].remainMoney > 0,No money left)", "source_mapping": {"start": 9218, "length": 71, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [217], "starting_column": 9, "ending_column": 80}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}}], "description": "RedEnvelop.drawback(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#213-229) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#214)\n\t- require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Not expired) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#215)\n\t- require(bool,string)(msg.sender == redEnvelopInfos[redEnvelopId].creator,Not creator) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#216)\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].remainMoney > 0,No money left) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#217)\n", "markdown": "[RedEnvelop.drawback(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L214)\n\t- [require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + ExpireDay,Not expired)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L215)\n\t- [require(bool,string)(msg.sender == redEnvelopInfos[redEnvelopId].creator,Not creator)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L216)\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].remainMoney > 0,No money left)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L217)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229", "id": "48b6f92fd196a043bdaeb05dd04a56a1cf12ae29f2f95f57ff75a737d11bd7e5", "check": "timestamp", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)", "source_mapping": {"start": 9782, "length": 74, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [232], "starting_column": 9, "ending_column": 83}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + CloseoutDay,Not closed)", "source_mapping": {"start": 9866, "length": 95, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [233], "starting_column": 9, "ending_column": 104}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}}, {"type": "node", "name": "require(bool,string)(redEnvelopInfos[redEnvelopId].remainMoney > 0,No money left)", "source_mapping": {"start": 10031, "length": 71, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [235], "starting_column": 9, "ending_column": 80}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}}], "description": "RedEnvelop.closeout(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#231-247) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#232)\n\t- require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + CloseoutDay,Not closed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#233)\n\t- require(bool,string)(redEnvelopInfos[redEnvelopId].remainMoney > 0,No money left) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#235)\n", "markdown": "[RedEnvelop.closeout(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L231-L247) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].creator != address(0),Invalid ID)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L232)\n\t- [require(bool,string)(block.timestamp > redEnvelopInfos[redEnvelopId].createTime + CloseoutDay,Not closed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L233)\n\t- [require(bool,string)(redEnvelopInfos[redEnvelopId].remainMoney > 0,No money left)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L235)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L231-L247", "id": "6e77cd22cb1f9c3e440f8794c9a3bd8e076d4281e07c32ef6ca62433cefa915b", "check": "timestamp", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}, {"type": "node", "name": "tokenAddr == address(0)", "source_mapping": {"start": 5091, "length": 23, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [142], "starting_column": 13, "ending_column": 36}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}}, {"type": "node", "name": "require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)", "source_mapping": {"start": 5274, "length": 72, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [147], "starting_column": 13, "ending_column": 85}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}}], "description": "RedEnvelop._send(address,address,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#140-149) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- tokenAddr == address(0) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#142)\n\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\t- require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#147)\n", "markdown": "[RedEnvelop._send(address,address,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L140-L149) uses timestamp for comparisons\n\tDangerous comparisons:\n\t- [tokenAddr == address(0)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L142)\n\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\t- [require(bool,string)(IERC20(tokenAddr).transfer(to,amount),Transfer Token failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L147)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L140-L149", "id": "d69ee869aeb25797800bbfb8138bcf308e2df5ba0c846d12ba873a56255a5d97", "check": "timestamp", "impact": "Low", "confidence": "Medium"}, {"elements": [{"type": "pragma", "name": "0.8.9", "source_mapping": {"start": 105, "length": 22, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [7], "starting_column": 1, "ending_column": 23}, "type_specific_fields": {"directive": ["solidity", "0.8", ".9"]}}], "description": "Pragma version0.8.9 (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#7) allows old versions\n", "markdown": "Pragma version[0.8.9](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L7) allows old versions\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L7", "id": "63b76d72d5831253627f786d82928a90b296859a3efd92a30fe88f8906aa93fe", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [], "description": "solc-0.8.9 is not recommended for deployment\n", "markdown": "solc-0.8.9 is not recommended for deployment\n", "first_markdown_element": "", "id": "f98c7afc3fe47e152024187afa3ad6234319c766cbd9eecabfe34e59dae45c5f", "check": "solc-version", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "ExpireDay", "source_mapping": {"start": 964, "length": 43, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [31], "starting_column": 5, "ending_column": 48}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable_constant", "convention": "UPPER_CASE_WITH_UNDERSCORES"}}], "description": "Constant RedEnvelop.ExpireDay (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#31) is not in UPPER_CASE_WITH_UNDERSCORES\n", "markdown": "Constant [RedEnvelop.ExpireDay](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L31) is not in UPPER_CASE_WITH_UNDERSCORES\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L31", "id": "137a68eeed677f71176c5c20630a9e8bd55019252d94452994b4ac5c51722376", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "LuckyDrawMamb", "source_mapping": {"start": 1176, "length": 49, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [35], "starting_column": 5, "ending_column": 54}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable_constant", "convention": "UPPER_CASE_WITH_UNDERSCORES"}}], "description": "Constant RedEnvelop.LuckyDrawMamb (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#35) is not in UPPER_CASE_WITH_UNDERSCORES\n", "markdown": "Constant [RedEnvelop.LuckyDrawMamb](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L35) is not in UPPER_CASE_WITH_UNDERSCORES\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L35", "id": "256826ec389528bc0230b58dbd004e655de992de1ee286e6fe1606d4d40d4011", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "_cal_random_amount", "source_mapping": {"start": 4308, "length": 640, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_cal_random_amount(uint256,uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function RedEnvelop._cal_random_amount(uint256,uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#124-138) is not in mixedCase\n", "markdown": "Function [RedEnvelop._cal_random_amount(uint256,uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138) is not in mixedCase\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L124-L138", "id": "377a1e6fb371f0c4470641f7beeb97d472dab30e30ebcfaeb799edf8c54cbf6d", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "BonusMamb", "source_mapping": {"start": 1126, "length": 44, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [34], "starting_column": 5, "ending_column": 49}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable_constant", "convention": "UPPER_CASE_WITH_UNDERSCORES"}}], "description": "Constant RedEnvelop.BonusMamb (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#34) is not in UPPER_CASE_WITH_UNDERSCORES\n", "markdown": "Constant [RedEnvelop.BonusMamb](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L34) is not in UPPER_CASE_WITH_UNDERSCORES\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L34", "id": "58a03085d5d95b24cdb88a02a990aa7a75501b7eb086cb5054fe55c3860b9f21", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "variable", "name": "CloseoutDay", "source_mapping": {"start": 1067, "length": 53, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [33], "starting_column": 5, "ending_column": 58}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}}, "additional_fields": {"target": "variable_constant", "convention": "UPPER_CASE_WITH_UNDERSCORES"}}], "description": "Constant RedEnvelop.CloseoutDay (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#33) is not in UPPER_CASE_WITH_UNDERSCORES\n", "markdown": "Constant [RedEnvelop.CloseoutDay](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L33) is not in UPPER_CASE_WITH_UNDERSCORES\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L33", "id": "6e58beaf89f80da6d82698ebe534c59ff23ed7cac33a2037c1e2506e3e5326e4", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "get_info", "source_mapping": {"start": 10499, "length": 573, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "get_info(uint256)"}, "additional_fields": {"target": "function", "convention": "mixedCase"}}], "description": "Function RedEnvelop.get_info(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#249-262) is not in mixedCase\n", "markdown": "Function [RedEnvelop.get_info(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L249-L262) is not in mixedCase\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L249-L262", "id": "a4da1807be6f06eaefceeff4dd678662cf0f4f45c5d7e2e95d7603f51326f7a1", "check": "naming-convention", "impact": "Informational", "confidence": "High"}, {"elements": [{"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 8218, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [200], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "LuckyDraw(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)", "source_mapping": {"start": 8709, "length": 122, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [208], "starting_column": 9, "ending_column": 131}, "type_specific_fields": {"parent": {"type": "function", "name": "luckydraw", "source_mapping": {"start": 7105, "length": 1757, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "luckydraw(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.luckydraw(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#182-211):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#200)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- LuckyDraw(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#208)\n", "markdown": "Reentrancy in [RedEnvelop.luckydraw(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L200)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [LuckyDraw(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L208)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L182-L211", "id": "02d9e6623b4cd42869721b9654581c53f07c2af2eb6c14d7038d85c71e2e29a1", "check": "reentrancy-unlimited-gas", "impact": "Informational", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount)", "source_mapping": {"start": 10356, "length": 61, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [243], "starting_column": 9, "ending_column": 70}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "CloseOut(redEnvelopId,amount)", "source_mapping": {"start": 10428, "length": 35, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [245], "starting_column": 9, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "closeout", "source_mapping": {"start": 9705, "length": 788, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "closeout(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.closeout(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#231-247):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#243)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- CloseOut(redEnvelopId,amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#245)\n", "markdown": "Reentrancy in [RedEnvelop.closeout(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L231-L247):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,owner,amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L243)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [CloseOut(redEnvelopId,amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L245)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L231-L247", "id": "369dd4368aaec6b4fb0a9e97d31e80b8334457152161ae9fb935a54bb933ea32", "check": "reentrancy-unlimited-gas", "impact": "Informational", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 6491, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [170], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "Open(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)", "source_mapping": {"start": 6952, "length": 117, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [178], "starting_column": 9, "ending_column": 126}, "type_specific_fields": {"parent": {"type": "function", "name": "open", "source_mapping": {"start": 5369, "length": 1730, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "open(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.open(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#151-180):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#170)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- Open(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#178)\n", "markdown": "Reentrancy in [RedEnvelop.open(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L170)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [Open(redEnvelopId,amount,redEnvelopInfos[redEnvelopId].remainMoney,redEnvelopInfos[redEnvelopId].remainCount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L178)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L151-L180", "id": "d02cabc24c7208e9a690ae91da8ee693f35be938d51c408f47ff6bbafd0c8f62", "check": "reentrancy-unlimited-gas", "impact": "Informational", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}, {"type": "node", "name": "_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)", "source_mapping": {"start": 9548, "length": 75, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [225], "starting_column": 9, "ending_column": 84}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "require(bool,string)(to.send(amount),Transfer ETH failed)", "source_mapping": {"start": 5163, "length": 47, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [144], "starting_column": 13, "ending_column": 60}, "type_specific_fields": {"parent": {"type": "function", "name": "_send", "source_mapping": {"start": 4954, "length": 409, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [140, 141, 142, 143, 144, 145, 146, 147, 148, 149], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "_send(address,address,uint256)"}}}, "additional_fields": {"underlying_type": "external_calls_sending_eth"}}, {"type": "node", "name": "DrawBack(redEnvelopId,amount)", "source_mapping": {"start": 9634, "length": 35, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [227], "starting_column": 9, "ending_column": 44}, "type_specific_fields": {"parent": {"type": "function", "name": "drawback", "source_mapping": {"start": 8868, "length": 831, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "RedEnvelop", "source_mapping": {"start": 841, "length": 10568, "filename_relative": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol", "is_dependency": false, "lines": [28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239, 240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272], "starting_column": 1, "ending_column": 0}}, "signature": "drawback(uint256)"}}}, "additional_fields": {"underlying_type": "event"}}], "description": "Reentrancy in RedEnvelop.drawback(uint256) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#213-229):\n\tExternal calls:\n\t- _send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#225)\n\t\t- require(bool,string)(to.send(amount),Transfer ETH failed) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#144)\n\tEvent emitted after the call(s):\n\t- DrawBack(redEnvelopId,amount) (../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#227)\n", "markdown": "Reentrancy in [RedEnvelop.drawback(uint256)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229):\n\tExternal calls:\n\t- [_send(redEnvelopInfos[redEnvelopId].tokenAddr,address(msg.sender),amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L225)\n\t\t- [require(bool,string)(to.send(amount),Transfer ETH failed)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L144)\n\tEvent emitted after the call(s):\n\t- [DrawBack(redEnvelopId,amount)](../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L227)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/c3/c3C52dac6d8BF4dA5e6d85f2C1A84409cCd39b3d_RedEnvelop.sol#L213-L229", "id": "d68bdded0dfa845315be07f857c98e260a81fe7f143bc4996db68ca8f5791432", "check": "reentrancy-unlimited-gas", "impact": "Informational", "confidence": "Medium"}]}}
