{"success": true, "error": null, "results": {"detectors": [{"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 338, "length": 212, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableContract", "source_mapping": {"start": 66, "length": 486, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}, {"type": "node", "name": "address(msg.sender).call{value: amount}()", "source_mapping": {"start": 455, "length": 43, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [17], "starting_column": 13, "ending_column": 56}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 338, "length": 212, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableContract", "source_mapping": {"start": 66, "length": 486, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}}, "additional_fields": {"underlying_type": "external_calls"}}, {"type": "node", "name": "balances[msg.sender] = 0", "source_mapping": {"start": 519, "length": 24, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [20], "starting_column": 9, "ending_column": 33}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 338, "length": 212, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableContract", "source_mapping": {"start": 66, "length": 486, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}}, "additional_fields": {"underlying_type": "variables_written", "variable_name": "balances"}}], "description": "Reentrancy in VulnerableContract.withdraw() (../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#13-21):\n\tExternal calls:\n\t- address(msg.sender).call{value: amount}() (../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#17)\n\tState variables written after the call(s):\n\t- balances[msg.sender] = 0 (../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#20)\n", "markdown": "Reentrancy in [VulnerableContract.withdraw()](../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L13-L21):\n\tExternal calls:\n\t- [address(msg.sender).call{value: amount}()](../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L17)\n\tState variables written after the call(s):\n\t- [balances[msg.sender] = 0](../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L20)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L13-L21", "id": "420a68b8e8f0b718ce6c47853f5e2026b48f051fa68d13c2e74adedec3eaf9d6", "check": "reentrancy-eth", "impact": "High", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 338, "length": 212, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableContract", "source_mapping": {"start": 66, "length": 486, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}, {"type": "node", "name": "address(msg.sender).call{value: amount}()", "source_mapping": {"start": 455, "length": 43, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [17], "starting_column": 13, "ending_column": 56}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 338, "length": 212, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableContract", "source_mapping": {"start": 66, "length": 486, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}}}], "description": "VulnerableContract.withdraw() (../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#13-21) ignores return value by address(msg.sender).call{value: amount}() (../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#17)\n", "markdown": "[VulnerableContract.withdraw()](../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L13-L21) ignores return value by [address(msg.sender).call{value: amount}()](../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L17)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L13-L21", "id": "71bddd66b1ae6b62e31dca4aff01699e403c5a6fe05a6a17adeed7c957fbb7cf", "check": "unchecked-lowlevel", "impact": "Medium", "confidence": "Medium"}, {"elements": [{"type": "function", "name": "withdraw", "source_mapping": {"start": 338, "length": 212, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableContract", "source_mapping": {"start": 66, "length": 486, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}, {"type": "node", "name": "address(msg.sender).call{value: amount}()", "source_mapping": {"start": 455, "length": 43, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [17], "starting_column": 13, "ending_column": 56}, "type_specific_fields": {"parent": {"type": "function", "name": "withdraw", "source_mapping": {"start": 338, "length": 212, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [13, 14, 15, 16, 17, 18, 19, 20, 21], "starting_column": 5, "ending_column": 6}, "type_specific_fields": {"parent": {"type": "contract", "name": "VulnerableContract", "source_mapping": {"start": 66, "length": 486, "filename_relative": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_absolute": "/Users/giacomoibba/Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "filename_short": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol", "is_dependency": false, "lines": [4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23], "starting_column": 1, "ending_column": 0}}, "signature": "withdraw()"}}}}], "description": "Low level call in VulnerableContract.withdraw() (../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#13-21):\n\t- address(msg.sender).call{value: amount}() (../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#17)\n", "markdown": "Low level call in [VulnerableContract.withdraw()](../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L13-L21):\n\t- [address(msg.sender).call{value: amount}()](../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L17)\n", "first_markdown_element": "../../../Desktop/SmarthER/mainnet/fe/fe4afb98416e3892c129e7508a7ed3078f605189_VulnerableContract.sol#L13-L21", "id": "d4ce023c407a627876815d49558aad2069e94e43b09643d908d0f0de325dc463", "check": "low-level-calls", "impact": "Informational", "confidence": "High"}]}}
